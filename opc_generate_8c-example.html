<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>libopc: opc_generate.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libopc
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">opc_generate.c</div>  </div>
</div><!--header-->
<div class="contents">
<p>Sample program which will read an OPC container and generate a "C" file which uses the API to generate the passed container.</p>
<div class="fragment"><div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment">    Generates &quot;C&quot; code from an OPC container template. The generated &quot;C&quot; code will then prgrammatically generate the container again.</span></div>
<div class="line"><span class="comment">    Very useful for generating boilerplate code.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">    Ussage:</span></div>
<div class="line"><span class="comment">    opc_generate FILENAME OUTNAME</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">    Sample:</span></div>
<div class="line"><span class="comment">    opc_generate helloworld.pptx helloworld.c</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="opc_8h.html">opc/opc.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;opc/internal.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;libxml/xmlsave.h&gt;</span></div>
<div class="line"><span class="preprocessor">#ifdef WIN32</span></div>
<div class="line"><span class="preprocessor">#include &lt;crtdbg.h&gt;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> add_visited_part(<a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a> **visited_parts_array, <a class="code" href="opc_2config_8h.html#a1158972139b1ac54ffb9fd4c0f0e43fa">opc_uint32_t</a> *visited_parts_count, <a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a> part) {</div>
<div class="line">    *visited_parts_array=(<a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a>*)xmlRealloc(*visited_parts_array, <span class="keyword">sizeof</span>(<a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a>)*(*visited_parts_count+1));</div>
<div class="line">    (*visited_parts_array)[(*visited_parts_count)++]=part;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <a class="code" href="opc_2config_8h.html#a441abb751b5d9c457c0cda9c4b5aa74a">opc_bool_t</a> is_visited_part(<a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a> *visited_parts_array, <a class="code" href="opc_2config_8h.html#a1158972139b1ac54ffb9fd4c0f0e43fa">opc_uint32_t</a> visited_parts_count, <a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a> part) {</div>
<div class="line">    <span class="keywordflow">for</span>(<a class="code" href="opc_2config_8h.html#a1158972139b1ac54ffb9fd4c0f0e43fa">opc_uint32_t</a> i=0;i&lt;visited_parts_count;i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (visited_parts_array[i]==part) {</div>
<div class="line">            <span class="keywordflow">return</span> <a name="a0"></a><a class="code" href="opc_2config_8h.html#aa2092f9f8f62c82f74177fe0331eb9d5">OPC_TRUE</a>;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <a name="a1"></a><a class="code" href="opc_2config_8h.html#a0ef226f5e97aeaedc343116ba0daaecf">OPC_FALSE</a>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> normalize_name(<span class="keywordtype">char</span> *dest, <span class="keyword">const</span> xmlChar *src, <a class="code" href="opc_2config_8h.html#a1158972139b1ac54ffb9fd4c0f0e43fa">opc_uint32_t</a> len) {</div>
<div class="line">    <a class="code" href="opc_2config_8h.html#a1158972139b1ac54ffb9fd4c0f0e43fa">opc_uint32_t</a> i=0;</div>
<div class="line">    <a class="code" href="opc_2config_8h.html#a1158972139b1ac54ffb9fd4c0f0e43fa">opc_uint32_t</a> j=0;</div>
<div class="line">    <span class="keywordflow">while</span>(j&lt;len &amp;&amp; 0!=src[i]) {</div>
<div class="line">        <span class="keywordflow">if</span> (src[i]==<span class="charliteral">&#39;/&#39;</span> || src[i]==<span class="charliteral">&#39;.&#39;</span> || src[i]==<span class="charliteral">&#39;-&#39;</span> || src[i]==<span class="charliteral">&#39;_&#39;</span> || src[i]==<span class="charliteral">&#39;[&#39;</span> || src[i]==<span class="charliteral">&#39;]&#39;</span>) {</div>
<div class="line">            dest[j++]=<span class="charliteral">&#39;_&#39;</span>; i++;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((src[i]&gt;=<span class="charliteral">&#39;A&#39;</span> &amp;&amp; src[i]&lt;=<span class="charliteral">&#39;Z&#39;</span>) || (src[i]&gt;=<span class="charliteral">&#39;a&#39;</span> &amp;&amp; src[i]&lt;=<span class="charliteral">&#39;z&#39;</span>) || (src[i]&gt;=<span class="charliteral">&#39;0&#39;</span> &amp;&amp; src[i]&lt;=<span class="charliteral">&#39;9&#39;</span>)) {</div>
<div class="line">            dest[j++]=src[i++];</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            j+=snprintf(dest+j, len-j, <span class="stringliteral">&quot;x%02X&quot;</span>, src[i++]);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (j&lt;len) dest[j]=0; <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j&gt;0) dest[j-1]=0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> xmlChar *xmlStrEscape(<span class="keyword">const</span> xmlChar *str) {</div>
<div class="line">    <a class="code" href="opc_2config_8h.html#a1158972139b1ac54ffb9fd4c0f0e43fa">opc_uint32_t</a> i=0;</div>
<div class="line">    <a class="code" href="opc_2config_8h.html#a1158972139b1ac54ffb9fd4c0f0e43fa">opc_uint32_t</a> a=0;</div>
<div class="line">    <span class="keywordflow">for</span>(;str[i]!=0;i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (<span class="charliteral">&#39;\\&#39;</span>==str[i]) {</div>
<div class="line">            a++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (0==a) {</div>
<div class="line">        <span class="keywordflow">return</span> xmlStrdup(str);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        xmlChar *ret = (xmlChar *) xmlMalloc((i + a + 1) * <span class="keyword">sizeof</span>(xmlChar));</div>
<div class="line">        <span class="keywordflow">for</span>(<a class="code" href="opc_2config_8h.html#a1158972139b1ac54ffb9fd4c0f0e43fa">opc_uint32_t</a> j=0, k=0;j&lt;=i;j++) {</div>
<div class="line">            <span class="keywordflow">if</span> (<span class="charliteral">&#39;\\&#39;</span>==str[j]) { ret[k++]=<span class="charliteral">&#39;\\&#39;</span>; ret[k++]=<span class="charliteral">&#39;\\&#39;</span>;} <span class="keywordflow">else</span> ret[k++]=str[j];</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> generate_relations(<a name="_a2"></a><a class="code" href="struct_o_p_c___c_o_n_t_a_i_n_e_r___s_t_r_u_c_t.html">opcContainer</a> *c, FILE *out, <a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a> root) {</div>
<div class="line">    <span class="keywordflow">for</span>(<a class="code" href="relation_8h.html#af0d261db83c93ac4e3749e7564d3f0d9">opcRelation</a> rel=<a name="a3"></a><a class="code" href="relation_8h.html#a3a2ad0b2011b5490693290f080ff6796">opcRelationFirst</a>(c, root)</div>
<div class="line">       ;<a name="a4"></a><a class="code" href="relation_8h.html#aba22c7fa74f33d3e7a9ddf5ce9d96613">OPC_RELATION_INVALID</a>!=rel</div>
<div class="line">       ;rel=<a name="a5"></a><a class="code" href="relation_8h.html#a825fc21945ba92c0c178445fcb9b6667">opcRelationNext</a>(c, root, rel)) {</div>
<div class="line">            <span class="keyword">const</span> xmlChar *prefix=NULL;</div>
<div class="line">            <a class="code" href="opc_2config_8h.html#a1158972139b1ac54ffb9fd4c0f0e43fa">opc_uint32_t</a> counter=OPC_CONTAINER_RELID_COUNTER_NONE;</div>
<div class="line">            <span class="keyword">const</span> xmlChar *type=NULL;</div>
<div class="line">            <a name="a6"></a><a class="code" href="relation_8h.html#a5cd4ec66468127ffdc8f7818dbb20aa3">opcRelationGetInformation</a>(c, root, rel, &amp;prefix, &amp;counter, &amp;type);</div>
<div class="line">            <span class="keywordtype">char</span> buf[20]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">            <span class="keywordflow">if</span> (OPC_CONTAINER_RELID_COUNTER_NONE!=counter) {</div>
<div class="line">                sprintf(buf, <span class="stringliteral">&quot;%i&quot;</span>, counter);</div>
<div class="line">            }</div>
<div class="line">            <a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a> internal_target=<a name="a7"></a><a class="code" href="relation_8h.html#ad16d69f41cf2e259dda7584d5bd4b103">opcRelationGetInternalTarget</a>(c, root, rel);</div>
<div class="line">            <span class="keywordflow">if</span> (<a name="a8"></a><a class="code" href="part_8h.html#aec5a57845a694d4d0303dad7250945ec">OPC_PART_INVALID</a>!=internal_target) {</div>
<div class="line">                <span class="keywordtype">char</span> part[<a name="a9"></a><a class="code" href="opc_2config_8h.html#a8f23ad59ca28532e9c4dd902c589291b">OPC_MAX_PATH</a>]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">                normalize_name(part, internal_target, <span class="keyword">sizeof</span>(part));</div>
<div class="line">                fprintf(out, <span class="stringliteral">&quot;     %sopcRelationAdd(c, %s, _X(\&quot;%s%s\&quot;), create_%s(c), _X(\&quot;%s\&quot;));\n&quot;</span>, </div>
<div class="line">                    (<a class="code" href="part_8h.html#aec5a57845a694d4d0303dad7250945ec">OPC_PART_INVALID</a>==root?<span class="stringliteral">&quot;&quot;</span>:<span class="stringliteral">&quot;     &quot;</span>), </div>
<div class="line">                    (<a class="code" href="part_8h.html#aec5a57845a694d4d0303dad7250945ec">OPC_PART_INVALID</a>==root?<span class="stringliteral">&quot;OPC_PART_INVALID&quot;</span>:<span class="stringliteral">&quot;ret&quot;</span>), </div>
<div class="line">                    prefix, buf, part, type);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                xmlChar *external_target=xmlStrEscape(<a name="a10"></a><a class="code" href="relation_8h.html#a668ef17f3a639c466b37bf7ad3233673">opcRelationGetExternalTarget</a>(c, root, rel));</div>
<div class="line">                <span class="keywordflow">if</span> (NULL!=external_target) {</div>
<div class="line">                    fprintf(out, <span class="stringliteral">&quot;     %sopcRelationAddExternal(c, %s, _X(\&quot;%s%s\&quot;), _X(\&quot;%s\&quot;), _X(\&quot;%s\&quot;));\n&quot;</span>, </div>
<div class="line">                        (<a class="code" href="part_8h.html#aec5a57845a694d4d0303dad7250945ec">OPC_PART_INVALID</a>==root?<span class="stringliteral">&quot;&quot;</span>:<span class="stringliteral">&quot;     &quot;</span>), </div>
<div class="line">                        (<a class="code" href="part_8h.html#aec5a57845a694d4d0303dad7250945ec">OPC_PART_INVALID</a>==root?<span class="stringliteral">&quot;OPC_PART_INVALID&quot;</span>:<span class="stringliteral">&quot;ret&quot;</span>), </div>
<div class="line">                        prefix, buf,</div>
<div class="line">                        external_target,</div>
<div class="line">                        type);</div>
<div class="line">                }</div>
<div class="line">                xmlFree(external_target);</div>
<div class="line">            }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> generate_binary_data(<a class="code" href="struct_o_p_c___c_o_n_t_a_i_n_e_r___s_t_r_u_c_t.html">opcContainer</a> *c, FILE *out, <a name="_a11"></a><a class="code" href="struct_o_p_c___c_o_n_t_a_i_n_e_r___i_n_p_u_t_s_t_r_e_a_m___s_t_r_u_c_t.html">opcContainerInputStream</a> *in) {</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;              static opc_uint8_t data[]={\n&quot;</span>);</div>
<div class="line">    <a class="code" href="opc_2config_8h.html#ad033af25faf0dfe6d3d2d1dc3629fc15">opc_uint8_t</a> buf[100];</div>
<div class="line">    <a class="code" href="opc_2config_8h.html#a1158972139b1ac54ffb9fd4c0f0e43fa">opc_uint32_t</a> len=0;</div>
<div class="line">    <span class="keywordtype">char</span> cont=<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line">    <span class="keywordflow">while</span>((len=<a name="a12"></a><a class="code" href="inputstream_8h.html#a04574329e12b6253650436066dcac2e0">opcContainerReadInputStream</a>(in, buf, <span class="keyword">sizeof</span>(buf)))&gt;0) {</div>
<div class="line">        fprintf(out, <span class="stringliteral">&quot;              &quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span>(<a class="code" href="opc_2config_8h.html#a1158972139b1ac54ffb9fd4c0f0e43fa">opc_uint32_t</a> i=0;i&lt;len;i++) {</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;%c 0x%02X&quot;</span>, cont, buf[i]);</div>
<div class="line">            cont=<span class="charliteral">&#39;,&#39;</span>;</div>
<div class="line">        }</div>
<div class="line">        fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;              };\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span>  xmlOutputWrite(<span class="keywordtype">void</span> * context, <span class="keyword">const</span> <span class="keywordtype">char</span> * buffer, <span class="keywordtype">int</span> len) {</div>
<div class="line">    FILE *out=(FILE*)context;</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;len;i++) {</div>
<div class="line">        <span class="keywordflow">switch</span>(buffer[i]) {</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;\n&#39;</span>:</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;\\n\&quot;);\n              writes(out, \&quot;&quot;</span>);</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;\r&#39;</span>:</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;&quot;&#39;</span>:</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;\\\&quot;&quot;</span>);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;\\&#39;</span>:</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;\\\\&quot;</span>);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">            putc(buffer[i], out);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> len;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> xmlOutputClose(<span class="keywordtype">void</span> * context) {</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> generate_xml_data(<a class="code" href="struct_o_p_c___c_o_n_t_a_i_n_e_r___s_t_r_u_c_t.html">opcContainer</a> *c, FILE *out, <a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a> part) {</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;              writes(out, \&quot;&quot;</span>);</div>
<div class="line">    xmlDocPtr doc=<a name="a13"></a><a class="code" href="xmlreader_8h.html#a58dd13d229dde4ffdccb215ba034de0c">opcXmlReaderReadDoc</a>(c, part, NULL, NULL, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (NULL!=doc) {</div>
<div class="line">        xmlSaveCtxtPtr save=xmlSaveToIO(xmlOutputWrite, xmlOutputClose, out, NULL, XML_SAVE_FORMAT | XML_SAVE_NO_DECL);</div>
<div class="line">        <span class="keywordflow">if</span> (NULL!=save) {</div>
<div class="line">            xmlSaveDoc(save, doc);</div>
<div class="line">            xmlSaveClose(save);</div>
<div class="line">        }</div>
<div class="line">        xmlFreeDoc(doc);</div>
<div class="line">    }</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;\&quot;);\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> generate_parts(<a class="code" href="struct_o_p_c___c_o_n_t_a_i_n_e_r___s_t_r_u_c_t.html">opcContainer</a> *c, FILE *out) {</div>
<div class="line">    <span class="keywordflow">for</span>(<a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a> part=<a name="a14"></a><a class="code" href="part_8h.html#a7877ddb59608539528225686d3a8ffc5">opcPartGetFirst</a>(c);<a class="code" href="part_8h.html#aec5a57845a694d4d0303dad7250945ec">OPC_PART_INVALID</a>!=part;part=<a name="a15"></a><a class="code" href="part_8h.html#abd5b2c4fbae5c41dfefa2950c455b96b">opcPartGetNext</a>(c, part)) {</div>
<div class="line">            <span class="keywordtype">char</span> norm_part[<a class="code" href="opc_2config_8h.html#a8f23ad59ca28532e9c4dd902c589291b">OPC_MAX_PATH</a>]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">            normalize_name(norm_part, part, <span class="keyword">sizeof</span>(norm_part));</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;static opcPart create_%s(opcContainer *c);\n&quot;</span>, norm_part);</div>
<div class="line">    }</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span>(<a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a> part=<a class="code" href="part_8h.html#a7877ddb59608539528225686d3a8ffc5">opcPartGetFirst</a>(c);<a class="code" href="part_8h.html#aec5a57845a694d4d0303dad7250945ec">OPC_PART_INVALID</a>!=part;part=<a class="code" href="part_8h.html#abd5b2c4fbae5c41dfefa2950c455b96b">opcPartGetNext</a>(c, part)) {</div>
<div class="line">            <span class="keywordtype">char</span> norm_part[<a class="code" href="opc_2config_8h.html#a8f23ad59ca28532e9c4dd902c589291b">OPC_MAX_PATH</a>]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">            normalize_name(norm_part, part, <span class="keyword">sizeof</span>(norm_part));</div>
<div class="line">            <span class="keyword">const</span> xmlChar *override_type=<a name="a16"></a><a class="code" href="part_8h.html#aa143f0205fc9dfce986a724f765873c7">opcPartGetTypeEx</a>(c, part, <a class="code" href="opc_2config_8h.html#aa2092f9f8f62c82f74177fe0331eb9d5">OPC_TRUE</a>);</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;static opcPart create_%s(opcContainer *c) {\n&quot;</span>, norm_part);</div>
<div class="line">            <span class="keywordflow">if</span> (NULL!=override_type) {</div>
<div class="line">                fprintf(out, <span class="stringliteral">&quot;     opcPart ret=opcPartFind(c, _X(\&quot;%s\&quot;), _X(\&quot;%s\&quot;), 0);\n&quot;</span>, part, override_type);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                fprintf(out, <span class="stringliteral">&quot;     opcPart ret=opcPartFind(c, _X(\&quot;%s\&quot;), NULL, 0);\n&quot;</span>, part);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (NULL!=override_type) {</div>
<div class="line">                fprintf(out, <span class="stringliteral">&quot;     if (OPC_PART_INVALID==ret &amp;&amp; OPC_PART_INVALID!=(ret=opcPartCreate(c, _X(\&quot;%s\&quot;), _X(\&quot;%s\&quot;), 0))) {\n&quot;</span>, part, override_type);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                fprintf(out, <span class="stringliteral">&quot;     if (OPC_PART_INVALID==ret &amp;&amp; OPC_PART_INVALID!=(ret=opcPartCreate(c, _X(\&quot;%s\&quot;), NULL, 0))) {\n&quot;</span>, part);</div>
<div class="line">            }</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;         //adding content\n&quot;</span>);</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;          opcContainerOutputStream *out=opcContainerCreateOutputStream(c, ret, OPC_COMPRESSIONOPTION_NORMAL);\n&quot;</span>);</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;          if (NULL!=out) {\n&quot;</span>);</div>
<div class="line">            <span class="keyword">const</span> xmlChar *type=<a name="a17"></a><a class="code" href="part_8h.html#ab2287beff0147ca5b81a678f6e7b3e16">opcPartGetType</a>(c, part);</div>
<div class="line">            <a class="code" href="opc_2config_8h.html#a1158972139b1ac54ffb9fd4c0f0e43fa">opc_uint32_t</a> type_len=(NULL!=type?xmlStrlen(type):0);</div>
<div class="line">            <span class="keywordflow">if</span> (type_len&gt;0 &amp;&amp; type[type_len-3]==<span class="charliteral">&#39;x&#39;</span> &amp;&amp; type[type_len-2]==<span class="charliteral">&#39;m&#39;</span> &amp;&amp; type[type_len-1]==<span class="charliteral">&#39;l&#39;</span>) {</div>
<div class="line">                generate_xml_data(c, out, part);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keywordflow">if</span> (<a name="a18"></a><a class="code" href="part_8h.html#ad8c2b071b5a9f23874d914f217cb393d">opcPartGetSize</a>(c, part)&gt;0) {</div>
<div class="line">                    <a class="code" href="struct_o_p_c___c_o_n_t_a_i_n_e_r___i_n_p_u_t_s_t_r_e_a_m___s_t_r_u_c_t.html">opcContainerInputStream</a> *in=<a name="a19"></a><a class="code" href="inputstream_8h.html#aa24c8ab45ffd5083e37508a3cd6fbb6b">opcContainerOpenInputStream</a>(c, part);</div>
<div class="line">                    <span class="keywordflow">if</span> (NULL!=in) {</div>
<div class="line">                        generate_binary_data(c, out, in);</div>
<div class="line">                        fprintf(out, <span class="stringliteral">&quot;              opcContainerWriteOutputStream(out, (const opc_uint8_t*)data, sizeof(data));\n&quot;</span>);</div>
<div class="line">                    }</div>
<div class="line">                    <a name="a20"></a><a class="code" href="inputstream_8h.html#a52a5bf5bb77f63a5698e849a00d39ff7">opcContainerCloseInputStream</a>(in);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;              opcContainerCloseOutputStream(out);\n&quot;</span>);</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;          }\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;          // adding relations\n&quot;</span>);</div>
<div class="line">            generate_relations(c, out, part);</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;     }\n&quot;</span>);</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;     return ret;\n&quot;</span>);</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;}\n&quot;</span>);</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> visit_all_parts(<a class="code" href="struct_o_p_c___c_o_n_t_a_i_n_e_r___s_t_r_u_c_t.html">opcContainer</a> *c, <a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a> root, <a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a> **visited_parts_array, <a class="code" href="opc_2config_8h.html#a1158972139b1ac54ffb9fd4c0f0e43fa">opc_uint32_t</a> *visited_parts_count) {</div>
<div class="line">    <span class="keywordflow">for</span>(<a class="code" href="relation_8h.html#af0d261db83c93ac4e3749e7564d3f0d9">opcRelation</a> rel=<a class="code" href="relation_8h.html#a3a2ad0b2011b5490693290f080ff6796">opcRelationFirst</a>(c, root)</div>
<div class="line">       ;<a class="code" href="relation_8h.html#aba22c7fa74f33d3e7a9ddf5ce9d96613">OPC_RELATION_INVALID</a>!=rel</div>
<div class="line">       ;rel=<a class="code" href="relation_8h.html#a825fc21945ba92c0c178445fcb9b6667">opcRelationNext</a>(c, root, rel)) {</div>
<div class="line">           <a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a> part=<a class="code" href="relation_8h.html#ad16d69f41cf2e259dda7584d5bd4b103">opcRelationGetInternalTarget</a>(c, root, rel);</div>
<div class="line">           <span class="keywordflow">if</span> (<a class="code" href="part_8h.html#aec5a57845a694d4d0303dad7250945ec">OPC_PART_INVALID</a>!=part) {</div>
<div class="line">               <span class="keywordflow">if</span> (!is_visited_part(*visited_parts_array, *visited_parts_count, part)) {</div>
<div class="line">                   add_visited_part(visited_parts_array, visited_parts_count, part);</div>
<div class="line">                   visit_all_parts(c, part, visited_parts_array, visited_parts_count);</div>
<div class="line">               }</div>
<div class="line">           }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> generate_weak_parts(<a class="code" href="struct_o_p_c___c_o_n_t_a_i_n_e_r___s_t_r_u_c_t.html">opcContainer</a> *c, FILE *out) {</div>
<div class="line">    <a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a> *visited_parts_array=NULL;</div>
<div class="line">    <a class="code" href="opc_2config_8h.html#a1158972139b1ac54ffb9fd4c0f0e43fa">opc_uint32_t</a> visited_parts_count=0;</div>
<div class="line">    visit_all_parts(c, <a class="code" href="part_8h.html#aec5a57845a694d4d0303dad7250945ec">OPC_PART_INVALID</a>, &amp;visited_parts_array, &amp;visited_parts_count);</div>
<div class="line">    <span class="keywordflow">for</span>(<a class="code" href="part_8h.html#a90e2f2ae4acb070b9dd0e62c8459e3de">opcPart</a> part=<a class="code" href="part_8h.html#a7877ddb59608539528225686d3a8ffc5">opcPartGetFirst</a>(c);<a class="code" href="part_8h.html#aec5a57845a694d4d0303dad7250945ec">OPC_PART_INVALID</a>!=part;part=<a class="code" href="part_8h.html#abd5b2c4fbae5c41dfefa2950c455b96b">opcPartGetNext</a>(c, part)) {</div>
<div class="line">        <span class="keywordflow">if</span> (!is_visited_part(visited_parts_array, visited_parts_count, part)) {</div>
<div class="line">            <span class="keywordtype">char</span> _part[<a class="code" href="opc_2config_8h.html#a8f23ad59ca28532e9c4dd902c589291b">OPC_MAX_PATH</a>]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">            normalize_name(_part, part, <span class="keyword">sizeof</span>(_part));</div>
<div class="line">            fprintf(out, <span class="stringliteral">&quot;     create_%s(c);\n&quot;</span>, _part);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (NULL!=visited_parts_array) {</div>
<div class="line">        xmlFree(visited_parts_array);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> generate(<a class="code" href="struct_o_p_c___c_o_n_t_a_i_n_e_r___s_t_r_u_c_t.html">opcContainer</a> *c, FILE *out, <span class="keyword">const</span> <span class="keywordtype">char</span> *template_name, <span class="keyword">const</span> <span class="keywordtype">char</span> *out_name) {</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;// Automatically generated by opc_generate \&quot;%s\&quot; \&quot;%s\&quot;.\n&quot;</span>, template_name, out_name);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;#include &lt;opc/opc.h&gt;\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;#ifdef WIN32\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;#include &lt;crtdbg.h&gt;\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;#endif\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;void writef(opcContainerOutputStream* stream, const char *s, ...) {\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;    va_list ap;\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;    va_start(ap, s);\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;    char buf[1024];\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;    int len=vsnprintf(buf, sizeof(buf), s, ap);\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;    opcContainerWriteOutputStream(stream, (const opc_uint8_t *)buf, len);\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;    va_end(ap);\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;}\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;void writes(opcContainerOutputStream* stream, const char *s) {\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;    int const len=strlen(s);\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;    opcContainerWriteOutputStream(stream, (const opc_uint8_t *)s, len);\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;}\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    generate_parts(c, out);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;void generate(opcContainer *c, FILE *out) {\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;     // adding registered extensions\n&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keyword">const</span> xmlChar *ext=<a name="a21"></a><a class="code" href="container_8h.html#ad440d1e3857d20f72e455cebb5fd5534">opcExtensionFirst</a>(c);NULL!=ext;ext=<a name="a22"></a><a class="code" href="container_8h.html#a598342c0928f0c2f9ba81bfb3cc7b705">opcExtensionNext</a>(c, ext)) {</div>
<div class="line">        <span class="keyword">const</span> xmlChar *type=<a name="a23"></a><a class="code" href="container_8h.html#a772928607b51e1ca1b0af0ed03083982">opcExtensionGetType</a>(c, ext);</div>
<div class="line">        fprintf(out, <span class="stringliteral">&quot;     opcExtensionRegister(c, _X(\&quot;%s\&quot;), _X(\&quot;%s\&quot;));\n&quot;</span>, ext, type);</div>
<div class="line">    }</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;     // adding root relations\n&quot;</span>);</div>
<div class="line">    generate_relations(c, out, <a class="code" href="part_8h.html#aec5a57845a694d4d0303dad7250945ec">OPC_PART_INVALID</a>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;     // adding weak parts, i.e. parts which are not referenced by a relation\n&quot;</span>);</div>
<div class="line">    generate_weak_parts(c, out);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;}\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;int main( int argc, const char* argv[] ) {\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;#ifdef WIN32\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;     _CrtSetDbgFlag (_CRTDBG_ALLOC_MEM_DF | _CRTDBG_LEAK_CHECK_DF);\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;#endif\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;    if (OPC_ERROR_NONE==opcInitLibrary() &amp;&amp; 2==argc) {\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;         opcContainer *c=NULL;\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;         if (NULL!=(c=opcContainerOpen(_X(argv[1]), OPC_OPEN_WRITE_ONLY, NULL, NULL))) {\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;              generate(c, stdout);\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;              opcContainerClose(c, OPC_CLOSE_NOW);\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;         }\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;    } else if (argc!=2) {\n&quot;</span>);</div>
<div class="line">    <span class="keywordtype">int</span> ofs=strlen(template_name); <span class="keywordflow">while</span>(ofs&gt;0 &amp;&amp; template_name[ofs-1]!=<span class="charliteral">&#39;/&#39;</span> &amp;&amp; template_name[ofs-1]!=<span class="charliteral">&#39;\\&#39;</span>) ofs--;</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;         printf(\&quot;target file needed!\\n E.g. %%s \\\&quot;%s\\\&quot;\&quot;, argv[0]);\n&quot;</span>, template_name+ofs);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;    }\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;    opcFreeLibrary();\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;#ifdef WIN32\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;    OPC_ASSERT(!_CrtDumpMemoryLeaks());\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;#endif\n&quot;</span>);</div>
<div class="line">    fprintf(out, <span class="stringliteral">&quot;}\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main( <span class="keywordtype">int</span> argc, <span class="keyword">const</span> <span class="keywordtype">char</span>* argv[] )</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#ifdef WIN32</span></div>
<div class="line">     _CrtSetDbgFlag (_CRTDBG_ALLOC_MEM_DF | _CRTDBG_LEAK_CHECK_DF);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line">    time_t start_time=time(NULL);</div>
<div class="line">    <a class="code" href="opc_2config_8h.html#ad7d9893293f0b826522b5ceab692ead4">opc_error_t</a> err=OPC_ERROR_NONE;</div>
<div class="line">    <span class="keywordflow">if</span> (OPC_ERROR_NONE==<a name="a24"></a><a class="code" href="opc_8h.html#a8fe8e972dfb6f6984f06536715b1261d">opcInitLibrary</a>() &amp;&amp; argc&gt;=2) {</div>
<div class="line">        <a class="code" href="struct_o_p_c___c_o_n_t_a_i_n_e_r___s_t_r_u_c_t.html">opcContainer</a> *c=NULL;</div>
<div class="line">        <span class="keywordflow">if</span> (NULL!=(c=<a name="a25"></a><a class="code" href="container_8h.html#a8ae84a6ce4e6bfcd4fce3744c4109fcd">opcContainerOpen</a>(_X(argv[1]), <a name="a26"></a><a class="code" href="container_8h.html#a414c34a498e4fe39653889f10e6d3fcda89c9f97aaf598775d730aab0a451bd66">OPC_OPEN_READ_ONLY</a>, NULL, NULL))) {</div>
<div class="line">            FILE *out=stdout;</div>
<div class="line">            <span class="keywordflow">if</span> (argc&gt;=3) {</div>
<div class="line">                out=fopen(argv[2], <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            generate(c, out, argv[1], argv[2]);</div>
<div class="line">            <span class="keywordflow">if</span> (stdout!=out) {</div>
<div class="line">                fclose(out);</div>
<div class="line">            }</div>
<div class="line">            <a name="a27"></a><a class="code" href="container_8h.html#aa0f21a48d99413c6a37ed638dd61b613">opcContainerClose</a>(c, <a name="a28"></a><a class="code" href="container_8h.html#a16196e15f50330293b5c7f2ee9b2fd5ca7a649e57c43c8e4e9a49589e9178df6c">OPC_CLOSE_NOW</a>);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            printf(<span class="stringliteral">&quot;ERROR: \&quot;%s\&quot; could not be opened.\n&quot;</span>, argv[1]);</div>
<div class="line">            err=OPC_ERROR_STREAM;</div>
<div class="line">        }</div>
<div class="line">        <a name="a29"></a><a class="code" href="opc_8h.html#a9bf3afd50cb3a5b7e024402f5680ace8">opcFreeLibrary</a>();</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (2==argc) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;ERROR: initialization of libopc failed.\n&quot;</span>);    </div>
<div class="line">        err=OPC_ERROR_STREAM;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        printf(<span class="stringliteral">&quot;opc_generate CONTAINERNAME CFILENAME\n\n&quot;</span>);</div>
<div class="line">        printf(<span class="stringliteral">&quot;Sample: opc_generate test.docx test.c\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    time_t end_time=time(NULL);</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;time %.2lfsec\n&quot;</span>, difftime(end_time, start_time));</div>
<div class="line"><span class="preprocessor">#ifdef WIN32</span></div>
<div class="line">    <a name="a30"></a><a class="code" href="opc_2config_8h.html#a96a07ca5b0204f3a9969b0e145c3e712">OPC_ASSERT</a>(!_CrtDumpMemoryLeaks());</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">    <span class="keywordflow">return</span> (OPC_ERROR_NONE==err?0:3);   </div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Mar 12 2016 17:24:12 for libopc by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
